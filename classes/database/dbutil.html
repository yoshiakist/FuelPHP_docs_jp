<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="./../../assets/css/combined.css">
	<link rel="shortcut icon" href="./../../favicon.ico" />
	<script src="http://www.google.com/jsapi" type="text/javascript"></script>
	<script type="text/javascript">
		var path = './../../';
		var class_prefix = "DBUtil::";
	</script>
	<script src="./../../assets/js/combined.js"></script>
	<title>DBUtil - Classes - FuelPHP Documentation</title>
</head>
<body>
	<div id="container">
		<header id="header">
			<div class="table">
				<h1>
					<strong>FuelPHP, a PHP 5.3 Framework</strong>
					Documentation
				</h1>

				<form id="google_search">
					<p>
						<span id="search_clear">&nbsp;</span>
						<input type="submit" name="search_submit" id="search_submit" value="search" />
						<input type="text" value="" id="search_input" name="search_input" />
					</p>
				</form>
			</div>
			<nav>

				<div class="clear"></div>
			</nav>
			<a href="#" id="toc_handle">table of contents</a>
			<div class="clear"></div>
		</header>

		<div id="cse">
			<div id="cse_point"></div>
			<div id="cse_content"></div>
		</div>

		<div id="main">

			<h2>DBUtil Class</h2>

			<p>DBUtil クラスは、データベースへの機械的な操作を管理し、実行できます。</p>

			<h3 id="managing">Managing functions</h3>

			<p>DBUtil は、データベースフィールドを作成、リネーム、変更、そして削除できます。</p>

			<article>
				<h4 class="method" id="method_set_connection">set_connection($connection)</h4>
				<p><strong>set_connection</strong> メソッドは、すべてのメソッドのデフォルトの DBUtil 接続を設定します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$connection</kbd></th>
										<td><strong>必須</strong></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception </td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>// DBUtil の別の接続を設定する
DBUtil::set_connection('my_database_group');

// この接続で別の DBUtil 呼び出しを行う
...

// デフォルトに戻す
DBUtil::set_connection(null);
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_create_database">create_database($database, charset = null, $if_not_exists = true, $db = null)</h4>
				<p><strong>create_database</strong> メソッドは、データベースを作成します。データベースを作成できない場合、例外 Database_Exception を投げます。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$database</kbd></th>
										<td><em>必須</em></td>
										<td>データベース名</td>
									</tr>
									<tr>
										<th><kbd>$charset</kbd></th>
										<td><em>null</em></td>
										<td>デフォルトの文字セット</td>
									</tr>
									<tr>
										<th><kbd>$if_not_exists</kbd></th>
										<td><strong>true</strong></td>
										<td><em>IF NOT EXISTS</em> を使用するかどうか</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>// `my_database` という名前のデータベースを作成する
DBUtil::create_database('my_database');

// 例外をキャッチする
try
{
	DBUtil::create_database('my_database');
}
catch(\Database_Exception $e)
{
	// 作成に失敗しました ...
}

// デフォルトの文字セットを設定することもできます。
// CREATE DATABASE IF NOT EXISTS `new_database` DEFAULT CHARACTER SET 'utf8'
DBUtil::create_database('new_database', 'utf8');

// CREATE DATABASE IF NOT EXISTS `new_database  DEFAULT CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci'
DBUtil::create_database('new_database', 'utf8_unicode_ci');
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
				<p>文字セットが指定されなかった場合、アクティブな db グループの文字セットにフォールバックします。</p>
			</article>

			<article>
				<h4 class="method" id="method_drop_database">drop_database($database, $db = null)</h4>
				<p><strong>drop_database</strong> メソッドは、データベースを削除します。削除できなかった場合、例外 Database_Exception を投げます。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$database</kbd></th>
										<td><em>必須</em></td>
										<td>データベース名</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>// `my_database` という名前のデータベースを削除する
DBUtil::drop_database('my_database');

// 例外をキャッチする
try
{
	DBUtil::drop_database('my_database');
}
catch(\Database_Exception $e)
{
	// 削除に失敗しました ...
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_table_exists">table_exists($table, $db = null)</h4>
				<p><strong>table_exists</strong> メソッドは、引数で指定したテーブルが存在するか確かめます。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<td><kbd>$table</kbd></td>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>テーブルが存在すれば true、存在しなければ false</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>// 'my_table' という名前のテーブルが存在するか確かめる
if(DBUtil::table_exists('my_table'))
{
	// テーブルが存在します。
} else
{
	// テーブルが存在しません。作成してください。
}</code>
								</pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_drop_table">drop_table($table, $db = null)</h4>
				<p><strong>drop_table</strong> メソッドは、テーブルを削除します。削除できなかった場合、例外 Database_Exception を投げます。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>// `my_table` という名前のテーブルを削除する
DBUtil::drop_table('my_table');

// 例外をキャッチする
try
{
	DBUtil::drop_table('my_table');
}
catch(\Database_Exception $e)
{
	// 削除に失敗しました ...
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_rename_table">rename_table($table, $new_table_name, $db = null)</h4>
				<p><strong>rename_table</strong> メソッドは、テーブルをリネームします。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>元のテーブル名</td>
									</tr>
									<tr>
										<th><kbd>$new_table_name</kbd></th>
										<td><em>必須</em></td>
										<td>新しいテーブル名</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>れい</th>
							<td>
								<pre class="php"><code>// `my_table` を `my_new_table` にリネームする
DBUtil::rename_table('my_table', 'my_new_table');

// 例外をキャッチする
try
{
	DBUtil::rename_table('my_table', 'my_new_table');
}
catch(\Database_Exception $e)
{
	// リネームに失敗しました ...
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_create_table">create_table($table, $fields, $primary_keys = array(), $if_not_exists = true, $engine = false, $charset = null, $foreign_keys = array(), $db = null)</h4>
				<p><strong>create_table</strong> メソッドは、テーブルを作成します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$fields</kbd></th>
										<td><em>必須</em></td>
										<td>フィールド名を含む配列</td>
									</tr>
									<tr>
										<th><kbd>$primary_keys</kbd></th>
										<td><strong>array()</strong></td>
										<td>プライマリキーを含む配列</td>
									</tr>
									<tr>
										<th><kbd>$if_not_exists</kbd></th>
										<td><strong>true</strong></td>
										<td><em>IF NOT EXISTS</em> を使うかどうか</td>
									</tr>
									<tr>
										<th><kbd>$engine</kbd></th>
										<td><strong>false</strong></td>
										<td>(MyISAM, InnoDB 等の) ストレージエンジンを使うか</td>
									</tr>
									<tr>
										<th><kbd>$charset</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td>デフォルトの文字セット(アクティブな db グループの文字セットにフォールバック)</td>
									</tr>
									<tr>
										<th><kbd>$foreign_keys</kbd></th>
										<td><strong>array()</strong></td>
										<td>外部キー制約の定義を含む配列。キー 'key' と 'reference' は必須で、これらが欠けていると例外を投げます。他のキーはオプションです。</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::create_table(
	'users',
	array(
		'id' => array('constraint' => 11, 'type' => 'int', 'auto_increment' => true),
		'name' => array('type' => 'text'),
		'email' => array('constraint' => 50, 'type' => 'varchar'),
		'title' => array('constraint' => 50, 'type' => 'varchar', 'default' => 'mr.'),
		'password' => array('constraint' => 125, 'type' => 'varchar'),
	),
	array('id'), false, 'InnoDB', 'utf8_unicode_ci',
	array(
		array(
			'constraint' => 'constraintA',
			'key' => 'keyA',
			'reference' => array(
				'table' => 'table',
				'column' => 'field',
			),
			'on_update' => 'CASCADE',
			'on_delete' => 'RESTRICT'
		),
		array(
			'key' => 'keyB',
			'reference' => array(
				'table' => 'table',
				'column' => array(
					'fieldA',
					'fieldB'
				),
			),
		),
	),
);

/* produces the following SQL statement:
CREATE TABLE `users` (
	`id` int(11) NOT NULL AUTO_INCREMENT,
	`name` text NOT NULL,
	`email` varchar(50) NOT NULL,
	`title` varchar(50) DEFAULT 'mr.' NOT NULL,
	`password` varchar(125) NOT NULL,
	PRIMARY KEY `id` (`id`),
	CONSTRAINT constraintA FOREIGN KEY (keyA) REFERENCES table (field) ON UPDATE CASCADE ON DELETE RESTRICT,
	FOREIGN KEY (keyB) REFERENCES table (fieldA, fieldB)
) ENGINE = InnoDB  DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci;
*/</code></pre>
							</td>
						</tr>
						<tr>
							<th>可能なパラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>name</kbd></th>
										<td>フィールド名</td>
									</tr>
									<tr>
										<th><kbd>type</kbd></th>
										<td>フィールド型 (varchar, enum, text, ...)</td>
									</tr>
									<tr>
										<th><kbd>constraint</kbd></th>
										<td>長さあるいは値。値は配列も可。</td>
									</tr>
									<tr>
										<th><kbd>charset</kbd></th>
										<td>フィールドの文字セット</td>
									</tr>
									<tr>
										<th><kbd>unsigned</kbd></th>
										<td>真偽値、符号無しなら <em>true</em>、デフォルトは <em>false</em></td>
									</tr>
									<tr>
										<th><kbd>default</kbd></th>
										<td>デフォルト値</td>
									</tr>
									<tr>
										<th><kbd>null</kbd></th>
										<td>真偽値、null を許可する場合は <em>true</em>、デフォルトは <em>false</em></td>
									</tr>
									<tr>
										<th><kbd>auto_increment</kbd></th>
										<td>オートインクリメントを使用する場合は <em>true</em> </td>
									</tr>
									<tr>
										<th><kbd>comment</kbd></th>
										<td>フィールドにコメントを追加する</td>
									</tr>
								</table>
							</td>
						</tr>
					</tbody>
				</table>

				<p>フィールドのデフォルト値はデフォルトでエスケープされます。この値をエスケープしたくない場合もあるでしょう。 その場合、<a href="./db.html#method_escape">DB::escape</a> を使用できます。</p>
				<pre class="php"><code>\DBUtil::create_table('users', array(
	'id' => array('constraint' => 11, 'type' => 'int', 'auto_increment' => true),
	'name' => array('type' => 'text'),
	'email' => array('constraint' => 50, 'type' => 'varchar'),
	'title' => array('constraint' => 50, 'type' => 'varchar', 'default' => 'mr.'),
	'created' => array('type' => 'timestamp', 'default' => \DB::expr('CURRENT_TIMESTAMP')),
	'password' => array('constraint' => 125, 'type' => 'varchar'),
), array('id'));
</code></pre>

				<p>値のエスケープは、DBUtil::add_fields でも DBUtil::modify_fields でも同様です。</p>

			</article>

			<article>
				<h4 class="method" id="method_field_exists">field_exists($table, $columns, $db = null)</h4>
				<p><strong>field_exists</strong> メソッドは、引数で指定したテーブルに引数で指定したフィールドが存在するか確かめます。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<td>$table</td>
										<td>必須</td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<td>$columns</td>
										<td>必須</td>
										<td>フィールド名を含む配列</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>フィールド／カラムが存在すれば true、存在しなければ false</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>
if(DBUtil::field_exists('my_table', array('my_field_or_column')))
{
	// フィールドが存在する
}
else
{
	// テーブルにフィールドが存在しない
}</code>
								</pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_add_fields">add_fields($table, $fields, $db = null)</h4>
				<p><strong>add_fields</strong> メソッドは、テーブルにフィールドを追加します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$fields</kbd></th>
										<td><em>必須</em></td>
										<td>フィールド名を含む配列</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::add_fields('users', array(
	'surname' => array('constraint' => 100, 'type' => 'varchar'),
	'twitter_name' => array('constraint' => 100, 'type' => 'varchar'),
));
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_drop_fields">drop_fields($table, $fields, $db = null)</h4>
				<p><strong>drop_fields</strong> メソッドは、テーブルからフィールドを削除します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$fields</kbd></th>
										<td><em>必須</em></td>
										<td>フィールド名を含む文字列または配列string or フィールド名を含む配列</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::drop_fields('users', 'surname');</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_modify_fields">modify_fields($table, $fields, $db = null)</h4>
				<p><strong>modify_fields</strong> メソッドは、テーブルのフィールドを変更します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$fields</kbd></th>
										<td><em>必須</em></td>
										<td>フィールド名を含む配列</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::modify_fields('users2', array(
	'name' => array('constraint' => 100, 'type' => 'varchar', 'charset' => 'utf8_general_ci'),
	'title' => array('constraint' => 50, 'type' => 'varchar', 'default' => 'mrs.'),
));
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_create_index">create_index($table, $index_columns, $index_name, $index = '', $db = null)</h4>
				<p><strong>create_index</strong> メソッドは、テーブルに二次インデックスを作成します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$index_columns</kbd></th>
										<td><em>必須</em></td>
										<td>mixed (フィールド名を含む文字列または配列)</td>
									</tr>
									<tr>
										<th><kbd>$index_name</kbd></th>
										<td><em>オプション</em></td>
										<td>作成するインデックス名</td>
									</tr>
									<tr>
										<th><kbd>$index</kbd></th>
										<td><em>オプション</em></td>
										<td>作成するインデックスタイプ。<br />現在サポートされているもの: UNIQUE, FULLTEXT, SPATIAL, NONCLUSTERED</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>データベース操作の結果</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::create_index('table', 'name');
// 生成される構文 CREATE INDEX name ON table ( `name` )

\DBUtil::create_index('table', array('nameA', 'nameB'), 'name');
// 生成される構文 CREATE INDEX name ON table ( `nameA`, `nameB` )

\DBUtil::create_index('table', array('nameA' => 'ASC', 'nameB'), 'name', 'fulltext');
// 生成される構文 CREATE FULLTEXT INDEX name ON table ( `nameA` ASC, `nameB` )
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_drop_index">drop_index($table, $index_name, $db = null)</h4>
				<p><strong>drop_index</strong> メソッドは、テーブルから二次インデックスを削除します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$index_name</kbd></th>
										<td><em>必須</em></td>
										<td>削除するインデックス名</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>データベース操作の結果</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::drop_index('table', 'name');
// 生成される構文 DROP INDEX name ON table
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>
			
			<article>
				<h4 class="method" id="method_add_foregin_key">add_foregin_key($table, $foreign_key)</h4>
				<p><strong>add_foreign_key</strong> メソッドは、テーブル作成後に、外部キーを追加します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$foreign_key</kbd></th>
										<td><em>必須</em></td>
										<td>外部キー定義を含む配列</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>データベース操作の結果</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>\InvalidArgumentException on invalid input, 失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::add_foreign_key('users', array(
	'constraint' => 'constraintA',
	'key' => 'keyA',
	'reference' => array(
		'table' => 'table',
		'column' => 'field',
	),
	'on_update' => 'CASCADE',
	'on_delete' => 'RESTRICT'
));</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>
			
			<article>
				<h4 class="method" id="method_drop_foreign_key">drop_foreign_key($table, $fk_name)</h4>
				<p><strong>drop_foreign_key</strong> メソッドは、テーブルから外部キーを削除します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td>テーブル名</td>
									</tr>
									<tr>
										<th><kbd>$fk_name</kbd></th>
										<td><em>必須</em></td>
										<td>削除する外部キー名</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>データベース操作の結果</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>失敗時に \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::drop_foreign_key('table', 'name');
// 生成される構文 ALTER TABLE `table` DROP FOREIGN KEY name
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<h3 id="database-operations">Database operations</h3>

			<article>
				<h4 class="method" id="method_truncate_table">truncate_table($table, $db = null)</h4>
				<p><strong>truncate_table</strong> メソッドは、テーブルを切りつめます。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td class="description">テーブル名.</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>影響する行の数</td>
						</tr>
						<tr>
							<th>例外</th>
							<td>サポートされていないとき \Database_Exception</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>\DBUtil::truncate_table('my_table');</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_analyze_table">analyze_table($table, $db = null)</h4>
				<p><strong>analyze_table</strong> メソッドは、テーブルを分析します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td class="description">テーブル名.</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>テーブルが OK なら <em>True</em>。注意が必要なら <em>False</em>。サポートされていなければ、エラーメッセージをログに記録する。</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>if(\DBUtil::analyze_table('table_name') === false)
{
	// 何か処理を行う
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_check_table">check_table($table, $db = null)</h4>
				<p><strong>check_table</strong> メソッドは、テーブルをチェックします。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td class="description">テーブル名.</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>テーブルが OK なら <em>True</em>。注意が必要なら <em>False</em>。サポートされていなければ、エラーメッセージをログに記録する。</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>if(\DBUtil::check_table('table_name') === false)
{
	// Do something
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_optimize_table">optimize_table($table, $db = null)</h4>
				<p>The <strong>optimize_table</strong> method optimizes a table.</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td class="description">テーブル名.</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td><em>True</em> if the table is OK or optimized. <em>False</em> on failure. If not supported or failed it logs the error message.</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>if(\DBUtil::optimize_table('table_name') === false)
{
	// 何か処理を行う
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

			<article>
				<h4 class="method" id="method_repair_table">repair_table($table, $db = null)</h4>
				<p><strong>repair_table</strong> メソッドは、テーブルを修復します。</p>
				<table class="method">
					<tbody>
						<tr>
							<th>静的</th>
							<td>はい</td>
						</tr>
						<tr>
							<th>パラメータ</th>
							<td>
								<table class="parameters">
									<tr>
										<th>Param</th>
										<th>デフォルト</th>
										<th class="description">説明</th>
									</tr>
									<tr>
										<th><kbd>$table</kbd></th>
										<td><em>必須</em></td>
										<td class="description">テーブル名.</td>
									</tr>
									<tr>
										<th><kbd>$db</kbd></th>
										<td><pre class="php"><code>null</code></pre></td>
										<td class="description">データベース接続</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<th>返り値</th>
							<td>テーブルが OK または修復された場合 <em>True</em>。失敗した場合 <em>false</em>。サポートされていない場合、失敗した場合はエラーメッセージをログに記録する。</td>
						</tr>
						<tr>
							<th>例</th>
							<td>
								<pre class="php"><code>if(\DBUtil::repair_table('table_name') === false)
{
	// 何か処理を行う
}
</code></pre>
							</td>
						</tr>
					</tbody>
				</table>
			</article>

		</div>

		<footer>
			<p>
				&copy; FuelPHP Development Team 2010-2012 - <a href="http://fuelphp.com">FuelPHP</a> is released under the MIT license.
			</p>
		</footer>
	</div>
</body>
</html>